<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 2: Human Practices & Education - Le Grand Jamboree</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
            background-color: #f8fafc; /* Base color */
        }
        
        /* Level 1 Theme (RED) */
        .custom-red {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }
        
        .text-custom-red {
            color: #dc2626;
        }
        
        .custom-gold {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .flip-card {
            perspective: 1000px;
            width: 100%;
            height: 220px;
        }
        
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }
        
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-weight: bold;
            cursor: pointer;
        }
        
        .flip-card-front {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: white;
        }
        
        .flip-card-back {
            background: white;
            color: #374151;
            border: 2px solid #dc2626;
            transform: rotateY(180deg);
        }
        
        /* Drag & Drop Styles */
        .drag-item {
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
            background-color: #fef2f2; 
            border: 1px solid #fca5a5;
            color: #b91c1c;
        }
        
        .drag-item:active {
            cursor: grabbing;
            transform: scale(1.05);
        }
        
        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        
        .drop-zone {
            transition: all 0.3s ease;
            border: 2px dashed #d1d5db;
            min-height: 80px;
            background-color: #f9fafb;
            padding: 20px; /* Added padding for better mobile target */
        }
        
        .drop-zone.drag-over {
            border-color: #f59e0b; 
            background-color: #fffbeb;
            transform: scale(1.02);
        }
        
        .drop-zone.correct {
            border-color: #10b981;
            background-color: #d1fae5;
            border-style: solid;
        }
        
        .drop-zone.incorrect {
            border-color: #ef4444;
            background-color: #fee2e2;
            border-style: solid;
        }

        .sequence-item {
            transition: all 0.3s ease;
            background-color: #dbeafe; 
            border: 1px solid #93c5fd;
            color: #1e40af;
        }

        /* Success Styles */
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-success {
            animation: pulseSuccess 0.6s ease;
        }
        
        @keyframes pulseSuccess {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .sponsor-money {
            animation: moneyPulse 2s infinite;
        }
        
        @keyframes moneyPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body class="min-h-full bg-gray-50 font-sans">
    <header class="bg-white shadow-sm border-b border-gray-100">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <a href="index.html">
                    <div class="flex items-center space-x-2">
                        <div class="w-10 h-10 sm:w-20 sm:h-20 rounded-full flex items-center justify-center">
                            <img src="FROG skippit RED.png" alt="igem barcelona-ub logo" class="w-full h-full object-cover p-2">
                        </div>
                        <span class="text-custom-red font-bold text-xl hidden sm:inline-block">LE GRAND JAMBOREE</span>
                        <span class="text-custom-red font-bold text-xl inline-block sm:hidden">MENU</span> 
                    </div>
                </a>
                <div class="flex items-center space-x-2 sm:space-x-4"> 
                    <div class="text-right flex flex-col items-end">
                        <div class="text-lg sm:text-xl font-bold text-gray-900" id="score">0 / 100 pts</div>
                        <div class="text-xs sm:text-sm text-gray-600">
                            <span class="inline-block sm:hidden">üí∞:</span> 
                            <span class="hidden sm:inline">üí∞ Sponsor:</span> 
                            <span id="sponsor-money" class="sponsor-money font-semibold">‚Ç¨5000</span>
                        </div>
                    </div>
                    <div class="w-16 sm:w-32 bg-gray-200 rounded-full h-2 flex-shrink-0">
                        <div id="progress-bar" class="progress-bar bg-red-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">
                Level 2: Human Practices & Education üåç
            </h1>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Learn French to engage the community and <strong>Enseigner</strong> your science!
            </p>
        </div>

        <section id="activity-1" class="activity-section mb-12">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">üß© 1. Flashcards: iGEM Action Vocabulary</h2>
                <p class="text-gray-600 mb-6">Click all cards to continue. (You'll use these words for the next activities!)</p>
                
                <div class="grid md:grid-cols-3 gap-6" id="flashcards-container">
                    </div>
                
                <div id="flashcard-success" class="hidden mt-6 text-center">
                    <div class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-lg mb-4">
                        <span class="mr-2">‚úÖ</span>
                        Excellent! You have mastered the action verbs.
                    </div>
                    <button onclick="completeActivity(1)" class="custom-red text-white px-6 py-2 rounded-lg hover:opacity-90 transition-opacity" disabled id="activity-1-complete">
                        Continue to the Ethics Mission ‚Üí
                    </button>
                </div>
            </div>
        </section>

        <section id="activity-2" class="activity-section mb-12 hidden">
            <div class="bg-white rounded-xl shadow-lg p-8 fade-in">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Ethics Mission: Save the Sponsor!</h2>
                <p class="text-gray-600 mb-4">The sponsor is panicking! Prove that your team masters <strong>√âthique</strong> by matching the Action to its Key Concept.</p>
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                    <p class="text-red-700 font-semibold">‚ö†Ô∏è Each mistake = -‚Ç¨1000! Current budget: <span id="current-budget">‚Ç¨5000</span></p>
                </div>

                
                <div class="grid lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-semibold mb-4 text-gray-700">Ethical Actions:</h3>
                        <div class="space-y-3" id="drag-items-activity-2">
                            </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold mb-4 text-gray-700">Key Concepts (Drop Zones):</h3>
                        <div class="space-y-3" id="drop-zones-activity-2">
                            </div>
                    </div>
                </div>
                
                <div id="matching-success" class="hidden mt-6 text-center">
                    <div class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-lg mb-4">
                        <span class="mr-2">üéâ</span>
                        Ethics Mission Accomplished!
                    </div>
                    <button id="activity-2-complete" class="custom-red text-white px-6 py-3 rounded-lg font-semibold hover:opacity-90 transition-opacity" onclick="completeActivity(2)" disabled>
                        ‚úì Continue to the Workshop Sequence
                    </button>
                </div>
            </div>
        </section>

        <section id="activity-3" class="activity-section mb-12 hidden">
            <div class="bg-white rounded-xl shadow-lg p-8 fade-in">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">üèÉ‚Äç‚ôÇÔ∏è 3. Workshop Sequence: Perfect Workshop!</h2>
                <p class="text-gray-600 mb-4">Organize the steps of the perfect workshop! Drag the steps into the Workshop Timeline (1 to 4) in order.</p>
                <div class="flex flex-col lg:flex-row gap-8">
                    
                    <div class="w-full lg:w-1/2">
                        <h3 class="font-semibold mb-4 text-gray-700">Steps to Order:</h3>
                        <div class="space-y-3" id="sequence-items">
                            </div>
                    </div>
                    
                    <div class="w-full lg:w-1/2">
                        <h3 class="font-semibold mb-4 text-gray-700">Workshop Timeline (Drop Zones):</h3>
                        <div class="space-y-3">
                            <div class="drop-zone p-6 rounded-lg border-2 border-dashed border-gray-300" data-position="1">
                                <div class="text-center text-gray-500"><div class="text-2xl mb-2">1Ô∏è‚É£</div><div class="font-semibold">Pr√©paration</div></div>
                            </div>
                            <div class="drop-zone p-6 rounded-lg border-2 border-dashed border-gray-300" data-position="2">
                                <div class="text-center text-gray-500"><div class="text-2xl mb-2">2Ô∏è‚É£</div><div class="font-semibold">Formation</div></div>
                            </div>
                            <div class="drop-zone p-6 rounded-lg border-2 border-dashed border-gray-300" data-position="3">
                                <div class="text-center text-gray-500"><div class="text-2xl mb-2">3Ô∏è‚É£</div><div class="font-semibold">Pratique</div></div>
                            </div>
                            <div class="drop-zone p-6 rounded-lg border-2 border-dashed border-gray-300" data-position="4">
                                <div class="text-center text-gray-500"><div class="text-2xl mb-2">4Ô∏è‚É£</div><div class="font-semibold">√âvaluation</div></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="sequence-success" class="hidden mt-6 text-center">
                    <div class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-lg mb-4">
                        <span class="mr-2">üéâ</span>
                        Perfect Workshop!
                    </div>
                    <button id="activity-3-complete" class="custom-red text-white px-6 py-3 rounded-lg font-semibold hover:opacity-90 transition-opacity" onclick="completeActivity(3)" disabled>
                        üéâ Finish the Level!
                    </button>
                </div>
            </div>
        </section>

        <section id="final-results" class="activity-section mb-8 bg-white rounded-lg p-6 shadow-md text-center hidden">
            <h2 class="text-3xl font-bold mb-4 text-green-600">üéâ F√©licitations!</h2>
            <p class="text-xl mb-4">You have mastered the iGEM vocabulary!</p>
            <div class="custom-gold text-white p-6 rounded-lg mb-6">
                <div class="text-2xl font-bold mb-2" id="final-score">Final Score: 0/100</div>
                <div class="text-lg">üèÜ Sponsor Satisfied - Final Budget: <span id="final-sponsor-budget">‚Ç¨5000</span></div>
                <div class="text-sm mt-2">You are ready for the iGEM Jamboree!</div>
            </div>
            <a href="level3.html" class="custom-red text-white block px-4 py-4 rounded-lg font-semibold text-lg hover:opacity-90 transition-opacity">
    üöÄ Proceed to Level 3: All-Nighter Lab
</a>
        </section>
    </main>

    <script>
        let currentActivity = 1;
        let score = 0;
        let sponsorMoney = 5000;
        let flippedCards = new Set();
        let completedMatches = 0;
        let sequenceComplete = false;
        // ELIMINADO: let timerInterval;
        // ELIMINADO: let timeLeft = 30; 
        
        // Data for Flashcards (Bilingual)
        const flashcards = [
            { french: "Enseigner", english: "To teach / Enseigner" },
            { french: "√âthique", english: "Ethics / √âthique" },
            { french: "Transparence", english: "Transparency / Transparence" },
            { french: "Engagement", english: "Engagement / Engagement" },
            { french: "Responsabilit√©", english: "Responsibility / Responsabilit√©" },
            { french: "Pr√©paration", english: "Preparation / Pr√©paration" },
            { french: "Formation", english: "Training / Formation" },
            { french: "Pratique", english: "Practice / Pratique" },
            { french: "√âvaluation", english: "Evaluation / √âvaluation" }
        ];

        // Data for Activity 2 (Ethics Mission)
        const ethicsData = [
            { concept: "transparence", action: '"I need to explain the risks of the technology to the public."' },
            { concept: "engagement", action: '"We will listen to the concerns of the local community."' },
            { concept: "responsabilite", action: '"We must share our safety data with other teams."' }
        ];

        // Data for Activity 3 (Workshop Sequence)
        const workshopSequenceData = [
            { order: "1", title: "üèóÔ∏è ", action: '"Organize the room and the materials."'},
            { order: "2", title: "üìö ", action: '"Next, teach the basics of the project in a simple way."'},
            { order: "3", title: "üß™ ", action: '"Show a small experiment to illustrate the science."'},
            { order: "4", title: "üìù ", action: '"Learn from our mistakes and make a report."'}
        ];

        // Utility function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }


        // --- GAME FLOW FUNCTIONS ---

        function initGame() {
            generateFlashcards();
            generateEthicsMission();
            generateWorkshopSequence();
            initializeDragAndDrop(); 
            updateProgress();
            updateSponsorMoney();
            document.getElementById('score').textContent = `${score} / 100 pts`;
            document.getElementById('activity-1').classList.remove('hidden');
        }

        function generateFlashcards() {
            const container = document.getElementById('flashcards-container');
            container.innerHTML = '';
            
            const cardsToShow = flashcards.slice(0, 9);
            
            cardsToShow.forEach((card) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'flip-card';
                cardElement.innerHTML = `
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <div class="text-2xl font-bold mb-2">${card.french}</div>
                            <div class="text-sm opacity-80">Click to view</div>
                        </div>
                        <div class="flip-card-back">
                            <div>
                                <div class="text-lg font-semibold text-gray-800 mb-2">${card.english}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                cardElement.addEventListener('click', () => {
                    if (!cardElement.classList.contains('flipped')) {
                        cardElement.classList.add('flipped');
                        flippedCards.add(card.french);
                        checkFlashcardCompletion();
                    }
                });
                
                container.appendChild(cardElement);
            });
        }

        function generateEthicsMission() {
            const dragContainer = document.getElementById('drag-items-activity-2');
            const dropContainer = document.getElementById('drop-zones-activity-2');
            dragContainer.innerHTML = '';
            dropContainer.innerHTML = '';

            const shuffledEthicsActions = shuffleArray([...ethicsData]);
            const shuffledEthicsConcepts = shuffleArray([...ethicsData]); // Shuffle for drop zones too

            // Generate Drag Items (Ethical Actions)
            shuffledEthicsActions.forEach(item => {
                const dragItem = document.createElement('div');
                dragItem.className = 'drag-item p-4 rounded-lg border hover:shadow-lg transition-all';
                dragItem.draggable = true;
                dragItem.setAttribute('data-answer', item.concept);
                dragItem.textContent = item.action;
                dragContainer.appendChild(dragItem);
            });

            // Generate Drop Zones (Key Concepts)
            shuffledEthicsConcepts.forEach(item => {
                let icon;
                if (item.concept === 'transparence') icon = 'üîç';
                else if (item.concept === 'engagement') icon = 'ü§ù';
                else if (item.concept === 'responsabilite') icon = 'üìã';

                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone p-6 rounded-lg flex items-center justify-center text-center';
                dropZone.setAttribute('data-target', item.concept);
                dropZone.innerHTML = `
                    <div><div class="text-2xl mb-2">${icon}</div><div class="text-lg font-semibold text-gray-800">${item.concept.charAt(0).toUpperCase() + item.concept.slice(1)}</div></div>
                `;
                dropContainer.appendChild(dropZone);
            });
        }

        function generateWorkshopSequence() {
            const sequenceContainer = document.getElementById('sequence-items');
            sequenceContainer.innerHTML = '';

            const shuffledSequenceItems = shuffleArray([...workshopSequenceData]);

            shuffledSequenceItems.forEach(item => {
                const sequenceItem = document.createElement('div');
                sequenceItem.className = 'drag-item sequence-item p-4 rounded-lg border cursor-pointer hover:scale-105 transition-transform';
                sequenceItem.draggable = true;
                sequenceItem.setAttribute('data-order', item.order);
                sequenceItem.innerHTML = `
                    <div class="font-semibold">${item.title}</div>
                    <div>${item.action}</div>
                `;
                sequenceContainer.appendChild(sequenceItem);
            });
        }
        
        function checkFlashcardCompletion() {
            if (flippedCards.size === 9) {
                document.getElementById('flashcard-success').classList.remove('hidden');
                document.getElementById('activity-1-complete').disabled = false;
                document.getElementById('activity-1-complete').classList.add('pulse-success');
                updateScore(30);
            }
        }
        
        function completeActivity(activityNumber) {
            const currentSection = document.getElementById(`activity-${activityNumber}`);
            
            currentSection.classList.add('hidden');
            
            if (activityNumber === 1) {
                // Flashcards -> Ethics Mission
                document.getElementById('activity-2').classList.remove('hidden');
                document.getElementById('activity-2').classList.add('fade-in');
                currentActivity = 2;
                updateProgress();
            } else if (activityNumber === 2) {
                // Ethics Mission -> Workshop Sequence
                document.getElementById('activity-3').classList.remove('hidden');
                document.getElementById('activity-3').classList.add('fade-in');
                currentActivity = 3;
                updateProgress();
                // ELIMINADO: startTimer();
            } else if (activityNumber === 3) {
                // Workshop Sequence -> Final Results
                // ELIMINADO: clearInterval(timerInterval);
                showFinalResults();
                document.getElementById('final-results').classList.remove('hidden');
                document.getElementById('final-results').classList.add('fade-in');
                currentActivity = 4;
            }
        }

        function updateProgress() {
            // Updated to reflect 3 activities (1, 2, 3)
            const progress = Math.round(((currentActivity - 1) / 3) * 100);
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        // --- GAMIFICATION FUNCTIONS ---

        function updateScore(points) {
            score += points;
            document.getElementById('score').textContent = `${score} / 100 pts`;
        }

        function updateSponsorMoney() {
            document.getElementById('sponsor-money').textContent = `‚Ç¨${sponsorMoney}`;
            document.getElementById('current-budget').textContent = `‚Ç¨${sponsorMoney}`;
            if (sponsorMoney <= 3000) {
                document.getElementById('sponsor-money').style.color = '#dc2626'; // Danger Red
            }
        }
        
        function createConfetti() {
            // Confetti effect (simplified)
            // Function for confetti effect (omitted for brevity, assume it exists or is simple like this)
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.position = 'fixed';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.borderRadius = '50%';
                confetti.style.zIndex = '9999';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.opacity = '0';
                confetti.style.transition = 'opacity 0.1s, transform 3s';
                confetti.style.transform = `translateY(${Math.random() * 100}vh) rotate(${Math.random() * 360}deg)`;
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.backgroundColor = ['#f59e0b', '#dc2626', '#10b981', '#3b82f6'][Math.floor(Math.random() * 4)];
                document.body.appendChild(confetti);

                setTimeout(() => {
                    confetti.style.opacity = '1';
                }, 10);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }
        
        function showFinalResults() {
            document.getElementById('final-score').textContent = `Final Score: ${score}/100`;
            document.getElementById('final-sponsor-budget').textContent = `‚Ç¨${sponsorMoney}`;
            createConfetti();
        }

        // ELIMINADO: startTimer function
        
        // --- DRAG & DROP FUNCTIONS ---

        function initializeDragAndDrop() {
            const mainContent = document.querySelector('main');
            
            mainContent.addEventListener('dragstart', handleDragStart);
            mainContent.addEventListener('dragend', handleDragEnd);
            mainContent.addEventListener('dragover', handleDragOver);
            mainContent.addEventListener('dragenter', handleDragEnter);
            mainContent.addEventListener('dragleave', handleDragLeave);
            mainContent.addEventListener('drop', handleDrop);
        }

        function handleDragStart(e) {
            const item = e.target.closest('.drag-item');
            // Check if the item is explicitly draggable (e.g., to prevent dragging if disabled)
            if (item && item.draggable) {
                item.classList.add('dragging');
                // Use different data for different activities
                const data = item.dataset.answer || item.dataset.order;
                e.dataTransfer.setData('text/plain', data);
                e.dataTransfer.effectAllowed = 'move';
            } else {
                 e.preventDefault(); 
            }
        }

        function handleDragEnd(e) {
            const item = e.target.closest('.drag-item');
            if (item) {
                item.classList.remove('dragging');
            }
        }

        function handleDragOver(e) {
            const zone = e.target.closest('.drop-zone');
            // Only allow drag over if it's a drop zone and the item hasn't been placed yet
            if (zone && !zone.classList.contains('correct') && zone.children.length < 2) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            }
        }

        function handleDragEnter(e) {
            const zone = e.target.closest('.drop-zone');
            if (zone && !zone.classList.contains('correct') && zone.children.length < 2) {
                zone.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            const zone = e.target.closest('.drop-zone');
            if (zone) {
                zone.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            const zone = e.target.closest('.drop-zone');
            // Stop if not a drop zone, or if a correct item is already placed (for activity 2)
            if (!zone || zone.classList.contains('correct') && currentActivity === 2) return;

            e.preventDefault();
            zone.classList.remove('drag-over');
            
            const draggedData = e.dataTransfer.getData('text/plain');
            
            if (currentActivity === 2) {
                handleActivity2Drop(e, draggedData, zone);
            } else if (currentActivity === 3) {
                handleActivity3Drop(e, draggedData, zone);
            }
        }

        function handleActivity2Drop(e, draggedData, zone) {
            const targetType = zone.dataset.target;
            const draggedElement = document.querySelector(`#drag-items-activity-2 [data-answer="${draggedData}"]`);
            
            if (draggedData === targetType) {
                zone.classList.add('correct');
                zone.classList.remove('incorrect');
                
                // Extract original content before overwriting
                const conceptTitleHTML = zone.querySelector('.text-lg').outerHTML;
                const actionText = draggedElement.textContent.trim();
                
                zone.innerHTML = `
                    <div class="p-2">
                        <div class="text-2xl mb-2">‚úÖ</div>
                        ${conceptTitleHTML}
                        <div class="text-sm text-gray-600 mt-1"><strong>CORRECT:</strong> ${actionText}</div>
                    </div>
                `;
                
                completedMatches++;
                
                if (draggedElement) {
                    // Remove the drag item from the drag area to show it's used
                    draggedElement.style.display = 'none'; 
                    draggedElement.draggable = false;
                }
                
                if (completedMatches === ethicsData.length) {
                    document.getElementById('matching-success').classList.remove('hidden');
                    document.getElementById('activity-2-complete').disabled = false;
                    document.getElementById('activity-2-complete').classList.add('pulse-success');
                    updateScore(35);
                }
            } else {
                zone.classList.add('incorrect');
                setTimeout(() => {
                    zone.classList.remove('incorrect');
                }, 1000);
                
                sponsorMoney = Math.max(0, sponsorMoney - 1000);
                updateSponsorMoney();
            }
        }

        function handleActivity3Drop(e, draggedData, zone) {
            
            // ELIMINADO: No hay verificaci√≥n de tiempo agotado

            const draggedOrder = draggedData;
            const targetPosition = zone.dataset.position;
            const draggedElement = document.querySelector(`#sequence-items [data-order="${draggedOrder}"]`);
            
            // Check if a drop zone is already filled, only for sequence
            if (zone.querySelector('.text-green-700')) {
                // Already filled correctly, should not happen but a safeguard
                return;
            }

            if (draggedElement && draggedOrder === targetPosition && zone.children.length < 2) {
                zone.classList.add('correct');
                zone.classList.remove('incorrect');
                
                // Find the original content
                const originalStepInfo = workshopSequenceData.find(item => item.order === draggedOrder);
                const stepTitle = originalStepInfo.title; // The emoji
                const actionText = originalStepInfo.action;

                zone.innerHTML = `
                    <div class="text-center text-gray-500 p-2">
                        <div class="text-2xl mb-2">üéâ</div>
                        <div class="font-semibold text-green-700">${stepTitle} - CORRECT!</div>
                        <div class="text-sm text-gray-800 mt-1"><strong>ACTION:</strong> ${actionText}</div>
                    </div>
                `;

                // Hide the element from the drag area
                draggedElement.style.display = 'none';
                draggedElement.draggable = false;
                
                const correctDrops = document.querySelectorAll('#activity-3 .drop-zone.correct').length;
                if (correctDrops === workshopSequenceData.length) {
                    sequenceComplete = true;
                    // ELIMINADO: clearInterval(timerInterval);
                    document.getElementById('sequence-success').classList.remove('hidden');
                    document.getElementById('activity-3-complete').disabled = false;
                    document.getElementById('activity-3-complete').classList.add('pulse-success');
                    updateScore(35);
                }
            } else {
                zone.classList.add('incorrect');
                setTimeout(() => {
                    zone.classList.remove('incorrect');
                }, 1000);
            }
        }


        // Initialisation
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>